<!DOCTYPE html>
<html lang="zh_cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第三方网易云音乐UI</title>
    <script src="jquery-3.7.1.js"></script>
    <script>
        if(window.location.href.includes('github')){
            document.getElementById("apiURL").value = "https://163music-api.qxiao.eu.org/"
        }
        function getURL(){
            return document.getElementById("apiURL").value
        }
        function simpleSearch(){
            $.get(getURL()+'/search?keywords=testify',(data,status) => {
                console.log(JSON.stringify(data))
            })
        }
        function Search(){
            var inp = document.getElementById("SearchInputBox").value
            var url = getURL()
            $.get(url+"/search?keywords="+inp,(data,status)=>{
                var list = document.getElementById("SearchList")
                var liststr = "<thead><th>id</th><th>名称</th><th>歌手</th><th>操作</th></tr></thead><tbody>"
                for(i in data['result']['songs']){
                    liststr += "<tr>"
                    a = data['result']['songs'][i]
                    liststr += "<td>"+a['id']+"</td>"
                    liststr += "<td>"+a['name']+"</td>"
                    var artslist = ""
                    for(ia in a['artists']){
                        iaa = a['artists'][ia]
                        artslist += iaa['name'] + " "
                    }
                
                    liststr += "<td>"+artslist+"</td>"
                    liststr += "<td><button onclick=\"play("+a['id']+")\">播放</button>"
                    liststr += "</tr>"
                }
                liststr += "</tbody>"
                list.innerHTML = liststr
            })
        }
        function play(id){
            document.getElementById("player").src = "https://music.163.com/outchain/player?type=2&id="+id+"&auto=1&height=66"
        }
    </script>
</head>
<body>
    <div>
        <input id="apiURL" type="url" value="http://127.0.0.1:3000">
    </div>
    <div>
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 id="player"></iframe>
    </div>
    <div>
        <input id="SearchInputBox" type="text" value="testify">
        <button onclick="Search()">搜索</button>
    </div>
    <div>
        <table id="SearchList" border="1">
            
        </table>
    </div>
</body>
</html>